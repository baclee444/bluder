<template>
  <div class="ghost-showcase">
    <header class="showcase-header">
      <h1>üé≠ Ghost Element Showcase</h1>
      <p class="subtitle">T√¨m hi·ªÉu v·ªÅ Ghost Element trong Web Builder</p>
    </header>

    <nav class="tab-navigation">
      <button
        v-for="tab in tabs"
        :key="tab.id"
        class="tab-button"
        :class="{ active: activeTab === tab.id }"
        @click="activeTab = tab.id"
      >
        {{ tab.icon }} {{ tab.label }}
      </button>
    </nav>

    <div class="tab-content">
      <!-- Tab 1: Gi·ªõi thi·ªáu -->
      <div v-if="activeTab === 'intro'" class="content-panel">
        <div class="intro-grid">
          <div class="intro-card">
            <div class="card-icon">üéØ</div>
            <h3>Ghost Element l√† g√¨?</h3>
            <p>
              <strong>Ghost Element</strong> (ph·∫ßn t·ª≠ ma) l√† b·∫£n sao b√°n trong su·ªët c·ªßa component
              xu·∫•t hi·ªán khi b·∫°n k√©o (drag) component trong web builder.
            </p>
            <p>
              N√≥ gi√∫p ng∆∞·ªùi d√πng th·∫•y r√µ v·ªã tr√≠ s·∫Ω th·∫£ component, c·∫£i thi·ªán tr·∫£i nghi·ªám k√©o-th·∫£ ƒë√°ng
              k·ªÉ.
            </p>
          </div>

          <div class="intro-card">
            <div class="card-icon">‚ú®</div>
            <h3>ƒê·∫∑c ƒëi·ªÉm ch√≠nh</h3>
            <ul>
              <li><strong>B√°n trong su·ªët:</strong> opacity: 0.5-0.7</li>
              <li><strong>Theo chu·ªôt:</strong> position: fixed</li>
              <li><strong>Kh√¥ng t∆∞∆°ng t√°c:</strong> pointer-events: none</li>
              <li><strong>T·ª± ƒë·ªông x√≥a:</strong> sau khi drop</li>
              <li><strong>Z-index cao:</strong> lu√¥n hi·ªÉn th·ªã tr√™n c√πng</li>
            </ul>
          </div>

          <div class="intro-card">
            <div class="card-icon">üîÑ</div>
            <h3>V√≤ng ƒë·ªùi</h3>
            <div class="lifecycle">
              <div class="lifecycle-step">
                <span class="step-number">1</span>
                <div class="step-content">
                  <strong>dragstart</strong>
                  <p>T·∫°o ghost element</p>
                </div>
              </div>
              <div class="lifecycle-arrow">‚Üí</div>
              <div class="lifecycle-step">
                <span class="step-number">2</span>
                <div class="step-content">
                  <strong>drag</strong>
                  <p>C·∫≠p nh·∫≠t v·ªã tr√≠</p>
                </div>
              </div>
              <div class="lifecycle-arrow">‚Üí</div>
              <div class="lifecycle-step">
                <span class="step-number">3</span>
                <div class="step-content">
                  <strong>dragend</strong>
                  <p>X√≥a ghost element</p>
                </div>
              </div>
            </div>
          </div>

          <div class="intro-card">
            <div class="card-icon">üí°</div>
            <h3>T·∫°i sao c·∫ßn Ghost Element?</h3>
            <ul>
              <li>‚úÖ Feedback tr·ª±c quan cho ng∆∞·ªùi d√πng</li>
              <li>‚úÖ Hi·ªÉn th·ªã r√µ v·ªã tr√≠ s·∫Ω th·∫£</li>
              <li>‚úÖ Tr√°nh m·∫•t component g·ªëc khi k√©o</li>
              <li>‚úÖ C·∫£i thi·ªán UX ƒë√°ng k·ªÉ</li>
              <li>‚úÖ Chu·∫©n trong c√°c builder hi·ªán ƒë·∫°i</li>
            </ul>
          </div>
        </div>

        <div class="comparison-preview">
          <h3>üìä So s√°nh nhanh</h3>
          <div class="comparison-table">
            <div class="table-row header">
              <div class="table-cell">Ti√™u ch√≠</div>
              <div class="table-cell">Kh√¥ng c√≥ Ghost</div>
              <div class="table-cell">C√≥ Ghost</div>
            </div>
            <div class="table-row">
              <div class="table-cell">Tr·∫£i nghi·ªám</div>
              <div class="table-cell">‚ùå K√©m</div>
              <div class="table-cell">‚úÖ T·ªët</div>
            </div>
            <div class="table-row">
              <div class="table-cell">Th·∫•y v·ªã tr√≠ th·∫£</div>
              <div class="table-cell">‚ùå Kh√¥ng</div>
              <div class="table-cell">‚úÖ C√≥</div>
            </div>
            <div class="table-row">
              <div class="table-cell">Feedback tr·ª±c quan</div>
              <div class="table-cell">‚ùå Kh√¥ng</div>
              <div class="table-cell">‚úÖ C√≥</div>
            </div>
            <div class="table-row">
              <div class="table-cell">ƒê·ªô ph·ª©c t·∫°p code</div>
              <div class="table-cell">‚úÖ ƒê∆°n gi·∫£n</div>
              <div class="table-cell">‚ö†Ô∏è Trung b√¨nh</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 2: Demo t∆∞∆°ng t√°c -->
      <div v-if="activeTab === 'demo'" class="content-panel">
        <GhostElementDemo />
      </div>

      <!-- Tab 3: So s√°nh -->
      <div v-if="activeTab === 'comparison'" class="content-panel">
        <GhostComparison />
      </div>

      <!-- Tab 4: Code -->
      <div v-if="activeTab === 'code'" class="content-panel">
        <div class="code-section">
          <h2>üíª Implementation Code</h2>

          <div class="code-example">
            <h3>1. Setup State</h3>
            <pre><code>import { ref } from 'vue'

interface Component {
  id: string
  label: string
  icon: string
}

// Ghost element state
const ghostElement = ref&lt;Component | null&gt;(null)
const ghostPosition = ref({ x: 0, y: 0 })</code></pre>
          </div>

          <div class="code-example">
            <h3>2. Handle Drag Start</h3>
            <pre><code>const handleDragStart = (event: DragEvent, component: Component) => {
  // T·∫°o ghost element
  ghostElement.value = component
  
  // ·∫®n default drag image c·ªßa browser
  if (event.dataTransfer) {
    const img = new Image()
    img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'
    event.dataTransfer.setDragImage(img, 0, 0)
    event.dataTransfer.effectAllowed = 'copy'
  }

  // L·∫Øng nghe s·ª± ki·ªán di chuy·ªÉn chu·ªôt
  document.addEventListener('dragover', updateGhostPosition)
}</code></pre>
          </div>

          <div class="code-example">
            <h3>3. Update Ghost Position</h3>
            <pre><code>const updateGhostPosition = (event: DragEvent) => {
  ghostPosition.value = {
    x: event.clientX + 10, // Offset ƒë·ªÉ kh√¥ng che chu·ªôt
    y: event.clientY + 10
  }
}</code></pre>
          </div>

          <div class="code-example">
            <h3>4. Handle Drag End</h3>
            <pre><code>const handleDragEnd = () => {
  // X√≥a ghost element
  ghostElement.value = null
  
  // Cleanup event listener
  document.removeEventListener('dragover', updateGhostPosition)
}</code></pre>
          </div>

          <div class="code-example">
            <h3>5. Template</h3>
            <pre><code>&lt;!-- Draggable component --&gt;
&lt;div
  draggable="true"
  @dragstart="handleDragStart($event, component)"
  @dragend="handleDragEnd"
&gt;
  {{ component.label }}
&lt;/div&gt;

&lt;!-- Ghost Element --&gt;
&lt;div
  v-if="ghostElement"
  class="ghost-element"
  :style="{
    left: ghostPosition.x + 'px',
    top: ghostPosition.y + 'px'
  }"
&gt;
  {{ ghostElement.label }}
&lt;/div&gt;</code></pre>
          </div>

          <div class="code-example">
            <h3>6. CSS Styling</h3>
            <pre><code>.ghost-element {
  position: fixed;           /* Theo chu·ªôt */
  pointer-events: none;      /* Kh√¥ng t∆∞∆°ng t√°c */
  opacity: 0.7;              /* B√°n trong su·ªët */
  z-index: 9999;             /* Lu√¥n ·ªü tr√™n */
  transform: rotate(-5deg);  /* Nghi√™ng nh·∫π */
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
  
  /* Animation cho sinh ƒë·ªông */
  animation: ghostFloat 0.3s ease-in-out infinite alternate;
}

@keyframes ghostFloat {
  from {
    transform: rotate(-5deg) translateY(0);
  }
  to {
    transform: rotate(-5deg) translateY(-4px);
  }
}</code></pre>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref } from "vue";
import GhostElementDemo from "./GhostElementDemo.vue";
import GhostComparison from "./GhostComparison.vue";

interface Tab {
  id: string;
  label: string;
  icon: string;
}

const tabs: Tab[] = [
  { id: "intro", label: "Gi·ªõi thi·ªáu", icon: "üìö" },
  { id: "demo", label: "Demo t∆∞∆°ng t√°c", icon: "üéÆ" },
  { id: "comparison", label: "So s√°nh", icon: "‚öñÔ∏è" },
  { id: "code", label: "Code", icon: "üíª" },
];

const activeTab = ref("intro");
</script>

<style scoped>
.ghost-showcase {
  min-height: 100vh;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  padding: 20px;
}

.showcase-header {
  text-align: center;
  color: white;
  margin-bottom: 30px;
}

.showcase-header h1 {
  font-size: 48px;
  font-weight: 700;
  margin-bottom: 8px;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.subtitle {
  font-size: 18px;
  opacity: 0.9;
}

.tab-navigation {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
  flex-wrap: wrap;
}

.tab-button {
  padding: 12px 24px;
  background: rgba(255, 255, 255, 0.2);
  color: white;
  border: 2px solid rgba(255, 255, 255, 0.3);
  border-radius: 8px;
  cursor: pointer;
  font-size: 16px;
  font-weight: 500;
  transition: all 0.3s;
  backdrop-filter: blur(10px);
}

.tab-button:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

.tab-button.active {
  background: white;
  color: #667eea;
  border-color: white;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.tab-content {
  max-width: 1400px;
  margin: 0 auto;
}

.content-panel {
  background: white;
  border-radius: 16px;
  padding: 32px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
}

/* Intro Grid */
.intro-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 24px;
  margin-bottom: 32px;
}

.intro-card {
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.card-icon {
  font-size: 48px;
  margin-bottom: 16px;
}

.intro-card h3 {
  color: #2c3e50;
  font-size: 20px;
  margin-bottom: 12px;
  font-weight: 600;
}

.intro-card p {
  color: #555;
  line-height: 1.6;
  margin-bottom: 12px;
}

.intro-card ul {
  list-style: none;
  padding: 0;
}

.intro-card li {
  color: #555;
  margin-bottom: 8px;
  padding-left: 0;
}

/* Lifecycle */
.lifecycle {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 16px;
}

.lifecycle-step {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.step-number {
  width: 32px;
  height: 32px;
  background: #667eea;
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
}

.step-content {
  text-align: center;
}

.step-content strong {
  color: #2c3e50;
  font-size: 14px;
  display: block;
  margin-bottom: 4px;
}

.step-content p {
  color: #666;
  font-size: 12px;
  margin: 0;
}

.lifecycle-arrow {
  font-size: 24px;
  color: #667eea;
  font-weight: bold;
}

/* Comparison Table */
.comparison-preview {
  background: white;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.comparison-preview h3 {
  color: #2c3e50;
  font-size: 20px;
  margin-bottom: 16px;
  font-weight: 600;
}

.comparison-table {
  border-radius: 8px;
  overflow: hidden;
  border: 1px solid #e9ecef;
}

.table-row {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
}

.table-row.header {
  background: #667eea;
  color: white;
  font-weight: 600;
}

.table-row:not(.header) {
  background: white;
}

.table-row:not(.header):nth-child(even) {
  background: #f8f9fa;
}

.table-cell {
  padding: 12px 16px;
  border-right: 1px solid #e9ecef;
}

.table-cell:last-child {
  border-right: none;
}

/* Code Section */
.code-section h2 {
  color: #2c3e50;
  font-size: 28px;
  margin-bottom: 24px;
  font-weight: 600;
}

.code-example {
  margin-bottom: 24px;
}

.code-example h3 {
  color: #34495e;
  font-size: 18px;
  margin-bottom: 12px;
  font-weight: 600;
}

.code-example pre {
  background: #282c34;
  color: #abb2bf;
  padding: 20px;
  border-radius: 8px;
  overflow-x: auto;
  font-family: "Monaco", "Courier New", monospace;
  font-size: 14px;
  line-height: 1.6;
}

.code-example code {
  color: #abb2bf;
}

@media (max-width: 1024px) {
  .intro-grid {
    grid-template-columns: 1fr;
  }

  .lifecycle {
    flex-direction: column;
  }

  .lifecycle-arrow {
    transform: rotate(90deg);
  }
}
</style>
